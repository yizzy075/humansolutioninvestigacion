<div class="container">
  <div class="form-card">
    <div class="header">
      <h1>HumanSolution</h1>
      <p>Sistema de Registro de Usuarios</p>
    </div>

    <!-- Mensaje de √©xito o error -->
    <div *ngIf="mensaje" class="mensaje" [ngClass]="mensaje.tipo">
      {{ mensaje.texto }}
    </div>

    <form [formGroup]="formularioRegistro" (ngSubmit)="registrarUsuario()">

      <!-- Nombre -->
      <div class="form-group">
        <label for="nombre">Nombre *</label>
        <input
          type="text"
          id="nombre"
          formControlName="nombre"
          [ngClass]="{
            'invalid': esInvalido('nombre'),
            'valid': esValido('nombre')
          }"
          placeholder="Ingrese el nombre"
          autocomplete="given-name">
        <span class="error-message" *ngIf="esInvalido('nombre')">
          {{ obtenerMensajeError('nombre') }}
        </span>
      </div>

      <!-- Apellido -->
      <div class="form-group">
        <label for="apellido">Apellido *</label>
        <input
          type="text"
          id="apellido"
          formControlName="apellido"
          [ngClass]="{
            'invalid': esInvalido('apellido'),
            'valid': esValido('apellido')
          }"
          placeholder="Ingrese el apellido"
          autocomplete="family-name">
        <span class="error-message" *ngIf="esInvalido('apellido')">
          {{ obtenerMensajeError('apellido') }}
        </span>
      </div>

      <!-- N√∫mero de Documento -->
      <div class="form-group">
        <label for="numeroDocumento">N√∫mero de Documento *</label>
        <input
          type="text"
          id="numeroDocumento"
          formControlName="numeroDocumento"
          [ngClass]="{
            'invalid': esInvalido('numeroDocumento'),
            'valid': esValido('numeroDocumento')
          }"
          placeholder="Ingrese el n√∫mero de documento"
          autocomplete="off">
        <span class="error-message" *ngIf="esInvalido('numeroDocumento')">
          {{ obtenerMensajeError('numeroDocumento') }}
        </span>
      </div>

      <!-- Correo Electr√≥nico -->
      <div class="form-group">
        <label for="correo">Correo Electr√≥nico *</label>
        <input
          type="email"
          id="correo"
          formControlName="correo"
          [ngClass]="{
            'invalid': esInvalido('correo'),
            'valid': esValido('correo')
          }"
          placeholder="usuario@ejemplo.com"
          autocomplete="email">
        <span class="error-message" *ngIf="esInvalido('correo')">
          {{ obtenerMensajeError('correo') }}
        </span>
      </div>

      <!-- Contrase√±a -->
      <div class="form-group">
        <label for="contrasenia">Contrase√±a *</label>
        <div class="password-container">
          <input
            [type]="mostrarContrasenia ? 'text' : 'password'"
            id="contrasenia"
            formControlName="contrasenia"
            [ngClass]="{
              'invalid': esInvalido('contrasenia'),
              'valid': esValido('contrasenia')
            }"
            placeholder="Ingrese su contrase√±a"
            autocomplete="new-password">
          <button
            type="button"
            class="toggle-password"
            (click)="toggleMostrarContrasenia()"
            tabindex="-1"
            aria-label="Mostrar/Ocultar contrase√±a">
            {{ mostrarContrasenia ? 'üôà' : 'üëÅÔ∏è' }}
          </button>
        </div>

        <!-- Mensaje de error general -->
        <span class="error-message" *ngIf="esInvalido('contrasenia')">
          {{ obtenerMensajeError('contrasenia') }}
        </span>

        <!-- Requisitos de contrase√±a (se muestra cuando el usuario empieza a escribir) -->
        <div class="password-requirements" *ngIf="formularioRegistro.get('contrasenia')?.dirty || formularioRegistro.get('contrasenia')?.touched">
          <p class="requirements-title">La contrase√±a debe cumplir:</p>
          <ul class="requirements-list">
            <li [ngClass]="{'requirement-met': cumpleMinCaracteres(), 'requirement-unmet': !cumpleMinCaracteres()}">
              <span class="requirement-icon">{{ cumpleMinCaracteres() ? '‚úì' : '‚úó' }}</span>
              M√≠nimo 8 caracteres
            </li>
            <li [ngClass]="{'requirement-met': cumpleMayuscula(), 'requirement-unmet': !cumpleMayuscula()}">
              <span class="requirement-icon">{{ cumpleMayuscula() ? '‚úì' : '‚úó' }}</span>
              Al menos una letra may√∫scula
            </li>
            <li [ngClass]="{'requirement-met': cumpleMinuscula(), 'requirement-unmet': !cumpleMinuscula()}">
              <span class="requirement-icon">{{ cumpleMinuscula() ? '‚úì' : '‚úó' }}</span>
              Al menos una letra min√∫scula
            </li>
            <li [ngClass]="{'requirement-met': cumpleNumero(), 'requirement-unmet': !cumpleNumero()}">
              <span class="requirement-icon">{{ cumpleNumero() ? '‚úì' : '‚úó' }}</span>
              Al menos un n√∫mero
            </li>
            <li [ngClass]="{'requirement-met': cumpleCaracterEspecial(), 'requirement-unmet': !cumpleCaracterEspecial()}">
              <span class="requirement-icon">{{ cumpleCaracterEspecial() ? '‚úì' : '‚úó' }}</span>
              Al menos un car√°cter especial (@#$%^&+=!)
            </li>
          </ul>
        </div>
      </div>

      <!-- Rol -->
      <div class="form-group">
        <label for="rol">Rol *</label>
        <select
          id="rol"
          formControlName="rol"
          [ngClass]="{
            'invalid': esInvalido('rol'),
            'valid': esValido('rol')
          }">
          <option value="">Seleccione un rol</option>
          <option *ngFor="let rol of roles" [value]="rol.id">{{ rol.nombre }}</option>
        </select>
        <span class="error-message" *ngIf="esInvalido('rol')">
          {{ obtenerMensajeError('rol') }}
        </span>
      </div>

      <!-- Botones -->
      <div class="button-group">
        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="cargando">
          <span *ngIf="!cargando">Registrar Usuario</span>
          <span *ngIf="cargando">‚è≥ Registrando...</span>
        </button>

        <button
          type="button"
          class="btn btn-secondary"
          (click)="limpiarFormulario()"
          [disabled]="cargando">
          Limpiar
        </button>
      </div>

      <p class="required-note">* Campos obligatorios</p>
    </form>
  </div>
</div>
